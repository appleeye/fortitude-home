<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd"> 
<html> 
    <head> 
        <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
        <title>张东亚的个人主页</title> 
        
        <!-- Standard reset, fonts and grids --> 
 
        <link rel="stylesheet" type="text/css" href="./css/reset-fonts-grids.css"> 
 
 
        <!-- CSS for Menu --> 
 
        <link rel="stylesheet" type="text/css" href="./css/menu.css">

        <!-- CSS for Override --> 
 
        <link rel="stylesheet" type="text/css" href="./css/fortitude.css"> 
 
        <!-- Page-specific styles --> 

    </head> 
    <body class="yui-skin-sam" id="yahoo-com"> 
 
        <div id="doc4" class="yui-t1"> 
            <div id="hd"> 
                <!-- start: your content here --> 
                    <h1>生命，是一次通往成熟和自由的旅程，不断追寻，才会活出精彩。</h1> 
                <!-- end: your content here --> 
            </div> 
            <div id="bd"> 
 
                <!-- start: primary column from outer template --> 
                <div id="yui-main"> 
                    <div class="yui-b"> 
                        <!-- start: stack grids here --> 
    <!-- Page published by Emacs Muse begins here --> 
<h3>Emacs源码阅读笔记</h3>

<p class="first">&nbsp;&nbsp;&nbsp;&nbsp;以Emacs bzr版本库的版本106082为基线，使用sloccount统计其代码规模，Emacs的源码中各类型代码所占比例如下：</p>

<ul>
<li>lisp:       1040391 (79.03%)</li>
<li>ansic:       253569 (19.26%)</li>
<li>objc:         10401 (0.79%)</li>
<li>sh:            8690 (0.66%)</li>
<li>perl:          1340 (0.10%)</li>
<li>cs:             770 (0.06%)</li>
<li>cpp:            528 (0.04%)</li>
<li>awk:            466 (0.04%)</li>
<li>python:         331 (0.03%)</li>
<li>java:            27 (0.00%)</li>
<li>sed:              4 (0.00%)</li>
</ul>

<p>&nbsp;&nbsp;&nbsp;&nbsp;因此可见，lisp代码在Emacs源码中占了很大的比例，除外如果阅读过Emacs Lisp Referrence Manual这篇文档的话，
应当注意过Introduction一节开篇即谈到：Emacs的大部分功能是由一种叫做Emacs Lisp的编程语言写成，现在单从代码
量看来，此话不假，至于如果有机会进一步阅读Emacs的源码时，就更加体会到这句话的意义，甚至创建Emacs的Frame的代
码，都是由Emacs Lisp写成（当然，还需要由C写成的一些builtin函数支撑）。</p>

<hr>

<h4>C代码</h4>

<h5><em>编译与调试</em></h5>


<h5><em>main函数</em></h5>


<h5><em>builtin函数</em></h5>

<ul>
<li><em>DEFUN宏</em>

<p>DEFUN用于在emacs的C源文件中定义一个builtin函数，定义之后，可以在syms_of_xxx(xxx是文件名)中通过defsubr安装
这个builtin函数，当然，在大多数情况下，我们实际上不需要增加builtin函数，除非Elisp不易实现期望的功能。</p>

<p>以下是DEFUN的定义以及使用DEFUN定义的一个核心函数：</p></li>
</ul>

<pre class="src">
<span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">This version of DEFUN declares a function prototype with the right
   arguments, so we can catch errors with maxargs at compile-time.  </span><span style="color: #ff7f24;">*/</span>
<span style="color: #b0c4de;">#define</span> <span style="color: #87cefa;">DEFUN</span>(<span style="color: #eedd82;">lname</span>, <span style="color: #eedd82;">fnname</span>, <span style="color: #eedd82;">sname</span>, <span style="color: #eedd82;">minargs</span>, <span style="color: #eedd82;">maxargs</span>, <span style="color: #eedd82;">intspec</span>, <span style="color: #eedd82;">doc</span>) \
  Lisp_Object <span style="color: #98fb98;">fnname</span> <span style="color: #eedd82;">DEFUN_ARGS_</span> ## maxargs ;       \
  <span style="color: #00ffff;">static</span> <span style="color: #87cefa;">DECL_ALIGN</span> (<span style="color: #00ffff;">struct</span> <span style="color: #98fb98;">Lisp_Subr</span>, sname) =       \
    { PVEC_SUBR,              \
      { .a ## maxargs = fnname },       \
      minargs, maxargs, lname, intspec, 0};       \
  <span style="color: #98fb98;">Lisp_Object</span> <span style="color: #eedd82;">fnname</span>
  
</pre>
<br>

<pre class="src">
DEFUN (<span style="color: #ffa07a;">"recursive-edit"</span>, Frecursive_edit, Srecursive_edit, 0, 0, <span style="color: #ffa07a;">""</span>,
       doc: /* Invoke the editor command loop recursively.
To get out of the recursive edit, a command can do `(throw <span style="color: #ffa07a;">'exit nil)'</span>;
that tells this function to <span style="color: #00ffff;">return</span>.
Alternatively, `(throw <span style="color: #ffa07a;">'exit t)'</span> makes this function signal an error.
This function <span style="color: #00ffff;">is</span> called by the editor initialization to begin editing.  */)
  (void)
{
  <span style="color: #b0c4de;">int</span> count = SPECPDL_INDEX ();
  /* &#20854;&#20182;&#20195;&#30721;&#24573;&#30053;... */
}
  
</pre>


<h5>eval处理</h5>


<h5>输入处理</h5>


<h5>字节码处理</h5>


<h5>X/Gtk处理</h5>


<h5>中文化处理</h5>

<hr>



<h4>Emacs Lisp代码</h4>

<h5>启动过程</h5>

<p>loadup.el
startup.el(top_level form定义)</p>


<h5>Fontify处理</h5>


<h5>各类Hook</h5>




<!-- Page published by Emacs Muse ends here -->
                        <!-- end: stack grids here --> 
<!-- Embed disqus plubgin to support comment system -->
<hr>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zdyblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
                    </div> 
                </div> 
                <!-- end: primary column from outer template --> 
 
                <!-- start: secondary column from outer template --> 
                <div class="yui-b"> 
		<div class="yuimenu">
		  <div class="bd">
		    <ul class="first-of-type">
		      <li class="yuimenuitem first-of-type menucenter"><a href="./index.html">首页</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="./thought.html">悟道</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="./tech.html">技术</a></li>		      		      		      
		      <li class="yuimenuitem first-of-type menucenter"><a href="./reading.html">读书</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="./traveling.html">旅行</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="./music.html">音乐</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="./blog/index.html">新版博客</a></li>		      		      		      
		      <li class="yuimenuitem first-of-type menucenter"><a href="http://weibo.com/zhangdongya">新浪微博</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="./link.html">个人链接</a></li>
		      <li class="yuimenuitem first-of-type menucenter"><a href="http://blog.4nian.com/index.php">旧版博客(废弃)</a></li>
                   </ul>
		  </div>
		</div>
                </div> 
                <!-- end: secondary column from outer template --> 
            </div> 
            <div id="ft"> 
 
                <p><b>Copyright © 2011 fortitude.zhang#gmail.com[change # to @ if you want to contact me:)]</b>  Page content by EMACS Muse---<a href="http://mwolson.org/projects/EmacsMuse.html"><img alt="muse logo" src="./image/muse-grey-bar.png" /></a></p> 
 
            </div> 
        </div> 
        
    </body> 
</html> 